#!/usr/bin/env bash

set -eo pipefail

cmd="curl --silent --location"
releases_path="https://api.github.com/repos/HaxeFoundation/haxe/releases?per_page=100"

if [ -n "$GITHUB_API_TOKEN" ]; then
  cmd="$cmd --header 'Authorization: token $GITHUB_API_TOKEN'"
fi

versions=$(eval "$cmd $releases_path" | grep 'tag_name' | sed -e 's/^[^:]*: "//;s/^v//;s/",$//' | sort --version-sort)

echo "$versions"
